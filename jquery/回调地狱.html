<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        .wrapper {
            width: 600px;
            margin: 100px auto 0px;
            border: 2px solid black;
            overflow: hidden;

        }

        .tpl {
            display: none;
        }

        .movieSection {
            float: left;
            width: 180px;
            height: 180px;
            padding: 10px;

        }

        .movieSection img {
            width: 100%;
            height: 150px;
            cursor: pointer;
        }

        .movieSection h3 {
            height: 30px;

        }
    </style>
</head>

<body>
    <div class='wrapper'>
        <div class="tpl">
            <img src=" "></img>
            <h3 class='moiveName'></h3>
        </div>
    </div>
    <script type="text/javascript" src="new_file.js"> </script>
    <script>
        // $.ajax({
        //     url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
        //     type: 'POST',
        //     data: {
        //         username: 'cst',
        //         password: '123123'
        //     },
        //     success: function (res) {
        //         if (res.data.poword = 'root') {
        //             $.ajax({
        //                 url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
        //                 type: 'GET',
        //                 success: function (res) {
        //                     console.log(res)
        //                     var a = res.data;
        //                     var $wrapper = $('.wrapper');
        //                     $.each(a, function (index, ele) {
        //                         var $movieSection = $('.tpl').clone().removeClass('tpl')
        //                             .addClass('movieSection');
        //                         $movieSection.data('id', ele.id).on('click',
        //                         function () {

        //                                 $.ajax({
        //                                     url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieInfo',
        //                                     type: 'GET',
        //                                     data: {
        //                                         movieId: $(this).data('id')
        //                                     },
        //                                     success: function (res) {
        //                                         console.log(res)
        //                                         var data = res.data;
        //                                         var direct = res.data
        //                                             .direct;
        //                                         var gut = res.data.gut;
        //                                         var mainActor = res.data
        //                                             .mainActor;
        //                                         var screenwriter = res
        //                                             .data.screenwriter;

        //                                         var htmlarr = '<div class="mask">\
        //                                         <p>导演：' + direct + '</p>\
        //                                         <p>导演：' + gut + '</p>\
        //                                         <p>导演：' + mainActor.reduce(function (prev, curv) {
        //                                             prev =
        //                                                 curv +
        //                                                 ' ';
        //                                             return prev;
        //                                         }, '') + '</p>\
        //                                         <p>导演：' + screenwriter.reduce(function (prev, curv) {
        //                                             prev =
        //                                                 curv +
        //                                                 ' ';
        //                                             return prev;
        //                                         }, '') + '</p>\
        //                                         </div>'

        //                                         $(htmlarr).appendTo(
        //                                             'body').css({
        //                                             position: "absolute",
        //                                             left: $(
        //                                                     window)
        //                                                 .outerWidth() /
        //                                                 2,
        //                                             bottom: 100,
        //                                             width: 400,
        //                                             marginLeft:
        //                                                 -200
        //                                         })
        //                                     }
        //                                 })

        //                             }).children()
        //                             .eq(0).attr('src', ele.poster)
        //                             .next().text(ele.name);
        //                         $wrapper.append($movieSection);
        //                     })
        //                 }
        //             })



        //         } else {

        //         }
        //     }


        // })




        (function () {
            return $.ajax({
                url: 'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/power',
                type: 'POST',
                data: {
                    username: 'cst',
                    password: '123123'
                }

            })
        })().then(function(res){
            if(res.data.power =='root'){
                return $.ajax({
                    url:'https://easy-mock.com/mock/5c09f40d3c098813c612cce6/movie/movieList',
                    type:'GET',
                })




            }else{

            }
        }).then(function(res){
            var data = res.data;
            var $wrapper = $('.wrapper');
          
            var self =this;
            $.each(data,function(index,ele){
                  var bj = $.Deferred();
                 var $tpl = $('.tpl').clone().removeClass('.tpl').addClass('.movieSection');
                 $tpl.data('id',ele.id).on('click',function(){
                  bj.resolve();
                 }).children().eq(0).attr('src',ele.poster).next().text('ele.name');
                $wrapper.append($tpl)
                return bj.promise();
            })
        }).then(function(res){

        })
    </script>


</body>

</html>